!function(m){if(!m.fn.dotdotdot){m.fn.dotdotdot=function(t){if(0==this.length)return function(t,e){if(!t)return;e="string"==typeof e?"dotdotdot: "+e:["dotdotdot:",e];window.console&&window.console.log&&window.console.log(e)}(!0,'No element found for "'+this.selector+'".'),this;if(1<this.length)return this.each(function(){m(this).dotdotdot(t)});var r=this;r.data("dotdotdot")&&r.trigger("destroy.dot"),r.bind_events=function(){return r.bind("update.dot",function(t,e){t.preventDefault(),t.stopPropagation(),a.maxHeight="number"==typeof a.height?a.height:function(t){var e=t.innerHeight(),n=["paddingTop","paddingBottom"];for(z=0,l=n.length;z<l;z++){var o=parseInt(t.css(n[z]),10);isNaN(o)&&(o=0),e-=o}return e}(r),a.maxHeight+=a.tolerance,void 0!==e&&(("string"==typeof e||e instanceof HTMLElement)&&(e=m("<div />").append(e).contents()),e instanceof m&&(i=e)),(c=r.wrapInner('<div class="dotdotdot" />').children()).empty().append(i.clone(!0)).css({height:"auto",width:"auto",border:"none",padding:0,margin:0});var n=!1,o=!1;return d.afterElement&&(n=d.afterElement.clone(!0),d.afterElement.remove()),b(c,a)&&(o="children"==a.wrap?function(t,e,n){var o=t.children(),r=!1;t.empty();for(var i=0,a=o.length;i<a;i++){var d=o.eq(i);if(t.append(d),n&&t.append(n),b(t,e)){d.remove(),r=!0;break}n&&n.remove()}return r}(c,a,n):function t(e,n,o,r,i){var a=e.contents(),d=!1;e.empty();for(var l=0,u=a.length;l<u&&!d;l++){var c=a[l],s=m(c);if(void 0!==c){if(e.append(s),i){var f=e.is("table, thead, tbody, tfoot, tr, col, colgroup, object, embed, param, ol, ul, dl, select, optgroup, option, textarea, script, style")?"after":"append";e[f](i)}3==c.nodeType?b(o,r)&&(d=w(s,n,o,r,i)):d=t(s,n,o,r,i),d||i&&i.remove()}}return d}(c,r,c,a,n)),c.replaceWith(c.contents()),c=null,m.isFunction(a.callback)&&a.callback.call(r[0],o,i),d.isTruncated=o}).bind("isTruncated.dot",function(t,e){return t.preventDefault(),t.stopPropagation(),"function"==typeof e&&e.call(r[0],d.isTruncated),d.isTruncated}).bind("originalContent.dot",function(t,e){return t.preventDefault(),t.stopPropagation(),"function"==typeof e&&e.call(r[0],i),i}).bind("destroy.dot",function(t){t.preventDefault(),t.stopPropagation(),r.unwatch().unbind_events().empty().append(i).data("dotdotdot",!1)}),r},r.unbind_events=function(){return r.unbind(".dot"),r},r.watch=function(){return r.unwatch(),"window"==a.watch?m(window).bind("resize.dot"+d.dotId,function(){u&&clearInterval(u),u=setTimeout(function(){r.trigger("update.dot")},10)}):(o=f(r),u=setInterval(function(){var t=f(r);o.width==t.width&&o.height==t.height||(r.trigger("update.dot"),o=f(r))},100)),r},r.unwatch=function(){return m(window).unbind("resize.dot"+d.dotId),u&&clearInterval(u),r};var e,n,i=r.contents(),a=m.extend(!0,{},m.fn.dotdotdot.defaults,t),d={},o={},u=null,c=null;return d.afterElement=(e=a.after,n=r,void 0!==e&&!!e&&("string"!=typeof e?"object"==typeof e&&void 0!==e.jquery&&e:!!(e=m(e,n)).length&&e)),d.isTruncated=!1,d.dotId=s++,r.data("dotdotdot",!0).bind_events().trigger("update.dot"),a.watch&&r.watch(),r},m.fn.dotdotdot.defaults={ellipsis:" . . . ",wrap:"letter",lastCharacter:{remove:[" ",",",";",".","!","?"],noEllipsis:[]},tolerance:0,callback:null,after:null,height:null,watch:!1,debug:!1};var s=1,e=m.fn.html;m.fn.html=function(t){return void 0!==t?this.data("dotdotdot")&&"function"!=typeof t?this.trigger("update",[t]):e.call(this,t):e.call(this)};var n=m.fn.text;m.fn.text=function(t){if(void 0===t)return n.call(this);if(this.data("dotdotdot")){var e=m("<div />");return e.text(t),t=e.html(),e.remove(),this.trigger("update",[t])}return n.call(this,t)}}function w(t,e,n,o,r){var i=!1,a=t[0];if(void 0===a)return!1;for(var d,l="letter"==o.wrap?"":" ",u=(d=a,d.innerText?d.innerText:d.nodeValue?d.nodeValue:d.textContent?d.textContent:"").split(l),c=-1,s=-1,f=0,h=u.length-1;f<=h;){var p=Math.floor((f+h)/2);if(p==s)break;s=p,y(a,u.slice(0,s+1).join(l)+o.ellipsis),b(n,o)?h=s:f=c=s}if(-1!=c){var v=u.slice(0,c+1).join(l);for(i=!0;-1<m.inArray(v.slice(-1),o.lastCharacter.remove);)v=v.slice(0,-1);m.inArray(v.slice(-1),o.lastCharacter.noEllipsis)<0&&(v+=o.ellipsis),y(a,v)}else{var g=t.parent();t.remove(),$n=g.contents().eq(-1),i=w($n,e,n,o,r)}return i}function b(t,e){return t.innerHeight()>e.maxHeight}function f(t){return{width:t.innerWidth(),height:t.innerHeight()}}function y(t,e){t.innerText?t.innerText=e:t.nodeValue?t.nodeValue=e:t.textContent&&(t.textContent=e)}}(jQuery);